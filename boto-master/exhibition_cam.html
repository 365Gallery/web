<!DOCTYPE html>
<html lang="zxx">
<head>
	<title>365 Gallery</title>
	<meta charset="UTF-8">
	<meta name="description" content="Boto Photo Studio HTML Template">
	<meta name="keywords" content="photo, html">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Stylesheets -->
	<link rel="stylesheet" href="css/bootstrap.min.css"/>
	<link rel="stylesheet" href="css/font-awesome.min.css"/>
	<link rel="stylesheet" href="css/slicknav.min.css"/>

	<!-- Main Stylesheets -->
	<link rel="stylesheet" href="css/style.css"/>


	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

</head>
<body>
	<!-- Page Preloder -->
	<div id="preloder">
		<div class="loader"></div>
	</div>

	<!-- Header Section -->
	<header class="header">
		<div class="container-fluid">
			<div class="row">
				<div class="col-sm-4 col-md-3 order-2 order-sm-1">
				</div>
				<div class="col-sm-4 col-md-6 order-1  order-md-2 text-center">
					<a href="./index.html" class="site-logo">
						<img src="img/logo.png" alt="" width=300 height=300>
					</a>
				</div>
				<div class="col-sm-4 col-md-3 order-3 order-sm-3">
				</div>
			</div>
			<nav class="main__menu">
				<ul class="nav__menu">
					<li><a href="./index.html">Home</a></li>
					<li><a href="./exhibition_pic.html" class="menu--active">Exhibition</a></li>
					<li><a href="./mygallery.html">My Gallery</a></li>
					<li><a href="./login.html">Log in</a></li>
				</ul>
			</nav>
		</div>
	</header>
	<!-- Header Section end -->

	<!-- About Page -->
	<section class="about__page">
		<div class="move-btn-pic">
			<button onClick="location.href='exhibition_pic.html'">이미지 전환</button>
		</div>
		<div class="cam-box">
			<div id="mycam" class="input-cam" autoplay>
			</div>
			<div class = "output-cam">
				<img src="http://34.64.170.176:8000/api/v1/media/output.jpeg" name="camReload" alt=""/>
			</div>

			<form><input type="button" value="Snap It" onClick="take_snapshot()"></form>
		</div>
	</section>
	<!-- About Page end -->

	<!-- Search Begin -->
	<div class="search-model">
		<div class="h-100 d-flex align-items-center justify-content-center">
			<div class="search-close-switch">+</div>
			<form class="search-model-form">
				<input type="text" id="search-input" placeholder="Search here.....">
			</form>
		</div>
	</div>
	<!-- Search End -->

	<!--====== Javascripts & Jquery ======-->
	<script src="js/vendor/jquery-3.2.1.min.js"></script>
	<script src="js/jquery.slicknav.min.js"></script>
	<script src="js/slick.min.js"></script>
	<script src="js/main.js"></script>
	<script src="js/webcam.js"></script>

	<!-- Script: Cam reload -->
	<script>
		setInterval(function(){
	    	timeTmp = new Date().getTime();
	    	timeTmp = "?"+ timeTmp;

	    	var target='camReload';
	    	newImage = document.images[target].src;

	    	idx = newImage.indexOf("?", 0);

	    	if(idx > 0){
	    		newImage = newImage.substr(0, idx);
	    	}
	    	document.images[target].src = newImage+timeTmp;
		}, 60000);
	</script>

	<!-- Script: Cam functions -->
	<script>
		function uploadSnap(img_src){
			var file =  img_src;
			var data = new FormData();
			data.append("webcam", file);

			$.ajax({
		        type: "POST",
		        enctype: 'multipart/form-data',
		        url: "http://34.64.170.176:8000/api/v1/images/",
		        data: data,
		        processData: false,
		        contentType: false,
		        cache: false,
		        timeout: 600000,
		        success: function (data) {
		        	alert('success')
		        },
		        error: function (e) {
		            alert('fail');
		        }
		    });
		}

		function take_snapshot() {
			Webcam.snap(function(data_uri) {
				uploadSnap(data_uri);
			});
		}

		function ShowCam(){
			Webcam.set({
			width: 500,
			height: 400,
			image_format: 'jpeg',
			jpeg_quality: 100
			});
			Webcam.attach('#mycam');
		}

		window.onload = ShowCam;
	</script>
	</body>
</html>